<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgroTrack Buyer Portal</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState } = React;
        const { CheckCircle, Clock, Package, TrendingUp, Phone } = {
            CheckCircle: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>,
            Clock: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>,
            Package: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="16.5" y1="9.4" x2="7.5" y2="4.21"></line><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>,
            TrendingUp: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline><polyline points="17 6 23 6 23 12"></polyline></svg>,
            Phone: (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
        };

        function BuyerPortal() {
          const [activeTab, setActiveTab] = useState('offers');
          const [offers, setOffers] = useState([
            {
              trade_id: 'a7b2c3d4',
              farmer_phone: '+254712345678',
              crop: 'Maize',
              quantity: '200kg',
              location: 'Kisumu',
              price_per_kg: 45,
              total_price: 9000,
              status: 'pending',
              pickup_time: 'Tomorrow 10:00 AM',
              otp: '846219'
            },
            {
              trade_id: 'e5f6g7h8',
              farmer_phone: '+254723456789',
              crop: 'Beans',
              quantity: '150kg',
              location: 'Eldoret',
              price_per_kg: 120,
              total_price: 18000,
              status: 'pending',
              pickup_time: 'Today 3:00 PM',
              otp: '553904'
            }
          ]);

          const [acceptedTrades, setAcceptedTrades] = useState([]);

          const handleAcceptOffer = (trade_id) => {
            const offer = offers.find(o => o.trade_id === trade_id);
            if (offer) {
              offer.status = 'accepted';
              setAcceptedTrades([...acceptedTrades, offer]);
              setOffers(offers.filter(o => o.trade_id !== trade_id));
            }
          };

          const handleReject = (trade_id) => {
            setOffers(offers.filter(o => o.trade_id !== trade_id));
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-green-50 to-emerald-100">
              <div className="container mx-auto px-4 py-8 max-w-6xl">
                <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                  <div className="flex items-center justify-between">
                    <div>
                      <h1 className="text-3xl font-bold text-green-800">AgroTrack Buyer Portal</h1>
                      <p className="text-gray-600 mt-1">Kisumu Farmers Co-op</p>
                    </div>
                    <div className="flex gap-4">
                      <div className="text-center">
                        <div className="text-2xl font-bold text-green-600">{offers.length}</div>
                        <div className="text-sm text-gray-600">New Offers</div>
                      </div>
                      <div className="text-center">
                        <div className="text-2xl font-bold text-blue-600">{acceptedTrades.length}</div>
                        <div className="text-sm text-gray-600">Accepted</div>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="bg-white rounded-lg shadow-lg mb-6">
                  <div className="flex border-b">
                    <button
                      onClick={() => setActiveTab('offers')}
                      className={`px-6 py-4 font-semibold ${
                        activeTab === 'offers'
                          ? 'text-green-600 border-b-2 border-green-600'
                          : 'text-gray-600'
                      }`}
                    >
                      Available Offers ({offers.length})
                    </button>
                    <button
                      onClick={() => setActiveTab('accepted')}
                      className={`px-6 py-4 font-semibold ${
                        activeTab === 'accepted'
                          ? 'text-green-600 border-b-2 border-green-600'
                          : 'text-gray-600'
                      }`}
                    >
                      Accepted Trades ({acceptedTrades.length})
                    </button>
                  </div>
                </div>

                {activeTab === 'offers' && (
                  <div className="space-y-4">
                    {offers.length === 0 ? (
                      <div className="bg-white rounded-lg shadow-lg p-12 text-center">
                        <Package className="mx-auto h-16 w-16 text-gray-400 mb-4" />
                        <p className="text-gray-600 text-lg">No pending offers</p>
                      </div>
                    ) : (
                      offers.map((offer) => (
                        <div key={offer.trade_id} className="bg-white rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow">
                          <div className="flex justify-between items-start mb-4">
                            <div>
                              <h3 className="text-2xl font-bold text-gray-800">{offer.crop}</h3>
                              <p className="text-gray-600">Trade ID: {offer.trade_id}</p>
                            </div>
                            <div className="text-right">
                              <div className="text-3xl font-bold text-green-600">
                                KES {offer.total_price.toLocaleString()}
                              </div>
                              <div className="text-sm text-gray-600">
                                @ KES {offer.price_per_kg}/kg
                              </div>
                            </div>
                          </div>

                          <div className="grid grid-cols-2 gap-4 mb-4">
                            <div className="flex items-center gap-2">
                              <Package className="h-5 w-5 text-green-600" />
                              <div>
                                <div className="text-sm text-gray-600">Quantity</div>
                                <div className="font-semibold">{offer.quantity}</div>
                              </div>
                            </div>
                            <div className="flex items-center gap-2">
                              <TrendingUp className="h-5 w-5 text-green-600" />
                              <div>
                                <div className="text-sm text-gray-600">Location</div>
                                <div className="font-semibold">{offer.location}</div>
                              </div>
                            </div>
                            <div className="flex items-center gap-2">
                              <Clock className="h-5 w-5 text-green-600" />
                              <div>
                                <div className="text-sm text-gray-600">Pickup Time</div>
                                <div className="font-semibold">{offer.pickup_time}</div>
                              </div>
                            </div>
                            <div className="flex items-center gap-2">
                              <Phone className="h-5 w-5 text-green-600" />
                              <div>
                                <div className="text-sm text-gray-600">Farmer</div>
                                <div className="font-semibold">{offer.farmer_phone}</div>
                              </div>
                            </div>
                          </div>

                          <div className="flex gap-3">
                            <button
                              onClick={() => handleAcceptOffer(offer.trade_id)}
                              className="flex-1 bg-green-600 hover:bg-green-700 text-white font-semibold py-3 rounded-lg transition-colors"
                            >
                              Accept & Create Escrow
                            </button>
                            <button
                              onClick={() => handleReject(offer.trade_id)}
                              className="px-6 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3 rounded-lg transition-colors"
                            >
                              Reject
                            </button>
                          </div>
                        </div>
                      ))
                    )}
                  </div>
                )}

                {activeTab === 'accepted' && (
                  <div className="space-y-4">
                    {acceptedTrades.length === 0 ? (
                      <div className="bg-white rounded-lg shadow-lg p-12 text-center">
                        <CheckCircle className="mx-auto h-16 w-16 text-gray-400 mb-4" />
                        <p className="text-gray-600 text-lg">No accepted trades yet</p>
                      </div>
                    ) : (
                      acceptedTrades.map((trade) => (
                        <div key={trade.trade_id} className="bg-white rounded-lg shadow-lg p-6">
                          <div className="flex justify-between items-start mb-4">
                            <div>
                              <h3 className="text-2xl font-bold text-gray-800">{trade.crop}</h3>
                              <p className="text-gray-600">Trade ID: {trade.trade_id}</p>
                            </div>
                            <div className="bg-green-100 text-green-800 px-4 py-2 rounded-full font-semibold">
                              Escrow Active
                            </div>
                          </div>

                          <div className="grid grid-cols-3 gap-4 mb-4">
                            <div>
                              <div className="text-sm text-gray-600">Quantity</div>
                              <div className="font-semibold">{trade.quantity}</div>
                            </div>
                            <div>
                              <div className="text-sm text-gray-600">Amount</div>
                              <div className="font-semibold">KES {trade.total_price.toLocaleString()}</div>
                            </div>
                            <div>
                              <div className="text-sm text-gray-600">Pickup</div>
                              <div className="font-semibold">{trade.pickup_time}</div>
                            </div>
                          </div>

                          <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <div className="text-sm text-blue-800 font-semibold mb-2">Delivery OTP</div>
                            <div className="text-3xl font-mono font-bold text-blue-600">{trade.otp}</div>
                            <div className="text-sm text-blue-700 mt-2">
                              Share this OTP with your driver for delivery confirmation
                            </div>
                          </div>
                        </div>
                      ))
                    )}
                  </div>
                )}

                <div className="mt-8 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg shadow-lg p-6 text-white">
                  <h3 className="font-bold text-lg mb-2">Powered by Hedera</h3>
                  <div className="grid grid-cols-3 gap-4 text-sm">
                    <div>
                      <div className="opacity-80">HCS Topic</div>
                      <div className="font-mono text-xs">0.0.123456</div>
                    </div>
                    <div>
                      <div className="opacity-80">Escrow Token</div>
                      <div className="font-mono text-xs">0.0.789012</div>
                    </div>
                    <div>
                      <div className="opacity-80">Network</div>
                      <div>Testnet</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          );
        }

        ReactDOM.render(<BuyerPortal />, document.getElementById('root'));
    </script>
</body>
</html>
